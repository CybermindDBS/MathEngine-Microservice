<!DOCTYPE html>
<html class="theme-dark" id="root" lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>MathEngine</title>
    <link href="../static/css/styles.css" rel="stylesheet"/>
    <link rel="stylesheet" th:href="@{/css/styles.css}"/>
</head>

<body class="theme-background">
<div class="site-header theme-background">
    <div class="left-section">
        <button class="site-name-btn" id="toggle-theme-btn">
            <h3 class="site-name theme-site-name">MathEngine</h3>
        </button>
    </div>
    <div class="right-section">
        <a class="btn theme-btn" href="/login" id="signInBtn" th:if="${!userAuthenticated}">Sign in</a>
        <form method="post" th:action="@{/logout}" th:if="${userAuthenticated}">
            <button class="btn theme-btn" id="logout-btn" type="submit" value="Logout">Logout</button>
        </form>
    </div>
</div>
<div class="main theme-background">


    <div class="left-pane theme-section">
        <div class="pane-controls-left">
            <form method="post" th:action="@{/new-calculation}">
                <button class="btn theme-btn" type="submit" value="New Calculation">New Calculation</button>
            </form>
        </div>
        <div class="calc-card-container">
            <form class="post-form3" id="calculation-selection" method="post" th:action="@{/select-calculation}">
                <input id="cald-id-field" name="calculationId" type="hidden" value="">
            </form>
            <textarea class="custom-textarea3 theme-text-area calculation" placeholder="New." readonly
                      th:attr="data-id=${calculation.id}"
                      th:classappend="${selectedCalculation.id == calculation.id} ? 'selected-calc' : ''"
                      th:each="calculation : ${calculations}"
                      th:text="${calculation.shortInputOutput != null} ? ${calculation.shortInputOutput} : ''"></textarea>
        </div>

        <form method="post" th:action="@{/navigate-pagination}" th:if="${!disablePrev || !disableNext}">
            <div class="pagination-controls">
                <button class="btn theme-btn" name="action" th:classappend="${disablePrev} ? 'btn-disable' : ''"
                        type="submit" value="previous">&lt
                </button>
                <button class="btn theme-btn" name="action" th:classappend="${disableNext} ? 'btn-disable' : ''"
                        type="submit" value="next">&gt
                </button>
            </div>
        </form>
    </div>
    <div class="vertical-resizer"></div>
    <div class="right-pane">
        <div class="top-section theme-section">
            <form class="post-form2" method="post" th:action="@{/calculate}" th:object="${selectedCalculation}">
                <div class="pane-controls-main">
                    <div class="pane-controls-main-left">
                        <a class="btn theme-btn" id="editFunctionsBtn">Edit Functions</a>
                        <button class="btn theme-btn" type="submit">Calculate</button>
                        <div class="loading-spinner" id="spinner" style="display: none;">
                            <div class="spinner"></div>
                        </div>
                    </div>
                    <div class="pane-controls-main-right">
                        <a class="btn theme-btn" id="helpBtn">Help</a>
                    </div>
                </div>
                <textarea class="custom-textarea code-area theme-text-area textarea-placeholder" placeholder="Type your expression here to calculate...

ex.
x + 2 * sqrt(4) / myfunction(3)
x = 10

public Integer myfunction(Integer i) {
  logger.log(&quot something to log&quot);
  return i * (i / 100);
}
" spellcheck="false" th:field="*{input}" th:text="*{input}"></textarea>
            </form>
        </div>
        <div class="horizontal-resizer"></div>
        <div class="bot-section theme-section">

                <textarea class="custom-textarea theme-text-area" placeholder="Result." readonly spellcheck="false"
                          style="display: block;"
                          th:text="${selectedCalculation != null} ? ${selectedCalculation.output != null ? selectedCalculation.output : ''}">
</textarea>


            <div class="edit-functions" style="display: none;">
                <form class="post-form" method="post" th:action="@{/save-functions}" th:object="${function}">
                        <textarea class="custom-textarea2 code-area theme-text-area" placeholder="Type your function here...

ex.
public Integer myfunction(Integer i) {
  logger.log(&quot something to log&quot);
  return i * (i / 100);
}
" spellcheck="false" th:field="*{functionString}"></textarea>
                    <div class="edit-functions-controls">
                        <a class="btn theme-btn" id="closeEditBtn">Close</a>
                        <button class="btn theme-btn" type="submit">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="blur-overlay" style="display: none;">
        <div class="sign-in-card theme-sign-in-card theme-overlay-card" id="sign-in" style="display: none;">
            <form method="post" th:action="@{/login}">
                <div class="sign-in-card-top-field" th:if="${param.error}">
                    <h4 class="sign-in-card-msg" th:text="${loginError}"></h4>
                </div>
                <div class="sign-in-card-top-field">
                    <label for="username">Username</label>
                    <input id="username" name="username" required type="text"/>
                </div>
                <div class="sign-in-card-top-field">
                    <label for="password">Password</label>
                    <input id="password" name="password" required type="password"/>
                </div>
                <div class="sign-in-card-bottom-fields">
                    <input class="theme-btn" type="submit" value="Login">
                    <hr class="theme-hr">
                    <a class="btn theme-btn" th:href="@{/oauth2/authorization/google}">Login with Google</a>
                    <a class="btn theme-btn" href="/register" id="showSignUpBtn">Register</a>
                </div>
            </form>
        </div>

        <div class="sign-in-card theme-sign-in-card theme-overlay-card" id="sign-up" style="display: none;">
            <form method="post" th:action="@{/register}">
                <div class="sign-in-card-top-field" th:if="${param.error}">
                    <h4 class="sign-in-card-msg" th:text="${registerError}"></h4>
                </div>
                <div class="sign-in-card-top-field">
                    <label for="sign-up-username">Username</label>
                    <input id="sign-up-username" name="username" required type="text"/>
                </div>
                <div class="sign-in-card-top-field">
                    <label for="sign-up-password">Password</label>
                    <input id="sign-up-password" name="password" required type="password"/>
                </div>
                <div class="sign-in-card-top-field">
                    <label for="confirm-password">Confirm Password</label>
                    <input id="confirm-password" name="confirmPassword" required type="password"/>
                </div>
                <div class="sign-in-card-bottom-fields">
                    <input class="theme-btn" type="submit" value="Register">
                </div>
            </form>
        </div>

        <div class="help-card theme-overlay-card" id="help" style="display: none;">
                <textarea class="custom-textarea theme-text-area" placeholder="" readonly spellcheck="false"
                          style="display: block;">
ğŸ“š MATH ENGINE â€“ QUICK GUIDE ğŸš€

âœ¨ 1) MAIN EXPRESSION
Type your main formula first â€“ the engine will crunch it!
Example:
trunc(digits, (426880 * sqrt(10005)) / sum(k, 0, (digits / 14), 1, part1))

ğŸ§® 2) VARIABLES
Define values to make formulas cleaner & smarter.
Example:
digits = 1000
precision = digits + pct(30, digits)
part1 = (-1)^k * (6*k)! * (545140134*k + 13591409) / part2
part2 = (3*k)! * (k!)^3 * 640320^(3*k)

Rules:
ğŸ“Œ Built-in: pi (precision follows math context)
ğŸ†• User-defined: Must match [a-zA-Z]([0-9])*

ğŸ’» 3) JAVA FUNCTIONS
Write your own logic in Java!
Example:
public int myfunction(int i) {
    logger.log("something to log");
    return i * 10;
}

âš™ï¸ 4) SUPPORTED OPERATIONS

â• Operators:
â• Add            â†’ 2 + 3
â– Subtract       â†’ 5 - 2
âœ–ï¸ Multiply       â†’ 4 * 7
â— Divide         â†’ 10 / 2
ğŸ”¼ Power         â†’ 2 ^ 8
ğŸ¯ Factorial     â†’ 5!
ğŸ“ abs(x)        â†’ abs(-7)
ğŸ“ sqrt(x)       â†’ sqrt(16)
ğŸ“¦ cubrt(x)      â†’ cubrt(27)
ğŸªœ nthroot(n,x)  â†’ nthroot(4, 81)
ğŸ¯ pct(n,x)      â†’ pct(30, 200)
ğŸ”„ recip(x)      â†’ recip(4)
ğŸ“Š logn(n,x)     â†’ logn(2, 8)
ğŸš€ exp(x)        â†’ exp(2)

ğŸ›  Built-in Functions:
âœ‚ trunc(n,x)                 â†’ trunc(5, pi)
Î£ sum(k,start,end,step,expr) â†’ sum(k, 0, 9, 1, k^2)
ğŸŒ€ fib(x)                     â†’ fib(5)

ğŸ“ 5) EXAMPLE WORKFLOW
1ï¸âƒ£ Write main expression:
trunc(digits, (426880 * sqrt(10005)) / sum(k, 0, (digits / 14), 1, part1)) + myfunction(10)

2ï¸âƒ£ Define variables (optional):
digits = 1000
precision = digits + pct(30, digits)
part1 = (-1)^k * (6*k)! * (545140134*k + 13591409) / part2
part2 = (3*k)! * (k!)^3 * 640320^(3*k)

3ï¸âƒ£ Define functions (optional):
public int myfunction(int i) {
    logger.log("something to log");
    return i * 10;
}

4ï¸âƒ£ Hit RUN âœ… and see the magic! âœ¨

ğŸ’¡ TIP:
Mix variables, constants & functions to create anything from quick math to series calculations!

</textarea>
        </div>
    </div>
</div>

<script src="../static/js/ui-toggle.js"></script>
<script src="../static/js/resize.js"></script>
<script src="../static/js/auto-format.js"></script>
<script src="../static/js/toggle-theme.js"></script>
<script src="../static/js/calc-selector.js"></script>
<script defer th:src="@{/js/ui-toggle.js}"></script>
<script defer th:src="@{/js/resize.js}"></script>
<script defer th:src="@{/js/auto-format.js}"></script>
<script defer th:src="@{/js/toggle-theme.js}"></script>
<script defer th:src="@{/js/calc-selector.js}"></script>
</body>

</html>